--- OSAPI.java
+++ OSAPI.java
@@ -5,6 +5,9 @@
  */
 package dan200.computercraft.core.apis;
 
+import cc.squiddev.cct.js.Callbacks;
+import org.teavm.jso.core.JSDate;
+import cc.squiddev.cct.stub.LuaDateTime;
 import dan200.computercraft.api.lua.IArguments;
 import dan200.computercraft.api.lua.ILuaAPI;
 import dan200.computercraft.api.lua.LuaException;
@@ -472,29 +475,24 @@
     public final Object date( Optional<String> formatA, Optional<Long> timeA ) throws LuaException
     {
         String format = formatA.orElse( "%c" );
-        long time = timeA.orElseGet( () -> Instant.now().getEpochSecond() );
+        long time = timeA.orElseGet( () -> Calendar.getInstance().getTimeInMillis() / 1000) * 1000;
 
-        Instant instant = Instant.ofEpochSecond( time );
-        ZonedDateTime date;
-        ZoneOffset offset;
+        Calendar instant;
         if( format.startsWith( "!" ) )
         {
-            offset = ZoneOffset.UTC;
-            date = ZonedDateTime.ofInstant( instant, offset );
+            instant = Calendar.getInstance(TimeZone.getTimeZone("UTC"));
+            instant.setTimeInMillis(time);
             format = format.substring( 1 );
         }
         else
         {
-            ZoneId id = ZoneId.systemDefault();
-            offset = id.getRules().getOffset( instant );
-            date = ZonedDateTime.ofInstant( instant, id );
+            instant = Calendar.getInstance();
+            instant.setTimeInMillis(time);
         }
 
-        if( format.equals( "*t" ) ) return LuaDateTime.toTable( date, offset, instant );
+        if( format.equals( "*t" ) ) return LuaDateTime.toTable( instant );
 
-        DateTimeFormatterBuilder formatter = new DateTimeFormatterBuilder();
-        LuaDateTime.format( formatter, format );
-        return formatter.toFormatter( Locale.ROOT ).format( date );
+        return Callbacks.strftime(format, JSDate.create(instant.getTimeInMillis()));
     }
 
 }
